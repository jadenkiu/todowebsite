<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8" />
    <title>Minimal To-Do List</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap">
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <h1>Minimal To-Do List</h1>
    <div class="container">
        <form id="new-task-form">
            <label for="new-task">New Task:</label>
            <input type="text" id="new-task" name="new-task" />
            <input type="submit" value="Add Task" style="font-family: Inter;" />
        </form>
        <ul id="task-list"></ul>
    </div>
    <script>
        const newTaskForm = document.getElementById("new-task-form");
        const newTaskInput = document.getElementById("new-task");
        const addTaskButton = newTaskForm.querySelector("input[type=submit]");
        const taskList = document.getElementById("task-list");

        // create new task
        function createNewTaskElement(taskText) {
            const listItem = document.createElement("li");
            const taskLabel = document.createElement("span");
            const deleteButton = document.createElement("button");
            const statusSelect = document.createElement("select");

            taskLabel.innerText = taskText;
            deleteButton.innerText = "x";
            deleteButton.classList.add("delete");

            const uncompleteOption = document.createElement("option");
            uncompleteOption.value = "uncomplete";
            uncompleteOption.text = "Uncomplete";

            const inProgressOption = document.createElement("option");
            inProgressOption.value = "in-progress";
            inProgressOption.text = "In Progress";

            const completeOption = document.createElement("option");
            completeOption.value = "complete";
            completeOption.text = "Complete";

            statusSelect.add(uncompleteOption);
            statusSelect.add(inProgressOption);
            statusSelect.add(completeOption);

            statusSelect.classList.add("status-select");

            listItem.appendChild(taskLabel);
            listItem.appendChild(statusSelect);
            listItem.appendChild(deleteButton);

            return listItem;
        }

        // add new task
        function addTask(event) {
            event.preventDefault();
            const taskText = newTaskInput.value.trim();

            if (taskText !== "") {
                const listItem = createNewTaskElement(taskText);
                taskList.appendChild(listItem);
                newTaskInput.value = "";
            }
        }

        // delete task
        function deleteTask(event) {
            if (event.target.classList.contains("delete")) {
                const listItem = event.target.parentNode;
                taskList.removeChild(listItem);
            }
        }

        // update task status
        function updateTaskStatus(event) {
            const listItem = event.target.parentNode;
            const status = event.target.value;

            listItem.classList.remove("uncomplete", "in-progress", "complete");
            listItem.classList.add(status);

            // save task status to local storage
            localStorage.setItem("tasks", taskList.innerHTML);
        }

        // load tasks from local storage
        function loadTasks() {
            const tasks = localStorage.getItem("tasks");

            if (tasks !== null) {
                taskList.innerHTML = tasks;
            }

            const statusSelects = taskList.querySelectorAll(".status-select");
            statusSelects.forEach((statusSelect) => {
                statusSelect.addEventListener("change", updateTaskStatus);
            });
        }

        // add event listeners
        newTaskForm.addEventListener("submit", addTask);
        taskList.addEventListener("click", deleteTask);

        loadTasks();
    </script>
    <div id="credits">
        <p>Made by </p><a href="https://github.com/jadenkiu">jadenkiu</a><br>
        <p>jadenkiu - Jaden Chung</p><a id = "portfolioLink" href="https://jadenkiu.github.io/jadenkiuportfolio">Portfolio here</a>
    </div>
</body>

</html>